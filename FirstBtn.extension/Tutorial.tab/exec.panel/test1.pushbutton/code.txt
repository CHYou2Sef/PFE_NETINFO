
from Autodesk.Revit.DB import *
from Autodesk.Revit.UI import *
from Autodesk.Revit.UI.Selection import *
from System.IO import StreamReader

uidoc = __revit__.ActiveUIDocument
doc = uidoc.Document

dialog = System.Windows.Forms.OpenFileDialog()
dialog.Filter = "test.txt"
dialog.InitialDirectory = os.path.expanduser("Y:\\0000\Etud\pythonRevit\FirstBtn.extension\Tutorial.tab\exec.panel\\test1.pushbutton")

dialog.Multiselect = False

if dialog.ShowDialog() == System.Windows.Forms.DialogResult.OK:
    selected_file = dialog.FileName
    with StreamReader(selected_file) as sr:
       content = sr.ReadToEnd()
       print(content,"\n")
    TaskDialog.Show("Contenu du fichier", content)


****************

import clr
import os

clr.AddReference('RevitAPI')
clr.AddReference('RevitAPIIFC')

from Autodesk.Revit.DB import *
from Autodesk.Revit.DB.IFC import *

uidoc = __revit__.ActiveUIDocument
doc = uidoc.Document

options = IFCFileReadOptions()
options.IncludeIFCSpaces = False
options.IncludeSiteElevation = False

ifc_file_path = os.path.join(os.path.dirname(__file__), 'test.txt')
ifc_importer = IFCImportOptions.CreateIFCImportOptions(doc, options)
imported_elements = IFCImportFile.Import(ifc_file_path, ifc_importer)

TaskDialog.Show("Importation terminée", f"{len(imported_elements)} éléments ont été importés à partir de {ifc_file_path}.")
